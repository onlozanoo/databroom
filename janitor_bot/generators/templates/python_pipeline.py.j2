{% import "macros.j2" as macros %}

{{ macros.header(date) }}

# Required installation: pip install janitor_bot
import pandas as pd
from janitor_bot.core.janitor import Janitor

# Load your dataset using Janitor
janitor_instance = Janitor.from_csv("{{ filename or 'your_data_file.csv' }}")
print(f"Original shape: {janitor_instance.get_df().shape}")

# Apply cleaning operations
{{steps}}

# Get the cleaned DataFrame
df_cleaned = janitor_instance.pipeline.df

# Display results
print("Data cleaning completed!")
print(f"Original shape: {janitor_instance.pipeline.df_original.shape}")
print(f"Final shape: {df_cleaned.shape}")
print(f"Columns removed: {janitor_instance.pipeline.df_original.shape[1] - df_cleaned.shape[1]}")
print(f"Rows removed: {janitor_instance.pipeline.df_original.shape[0] - df_cleaned.shape[0]}")
print("\nFirst 5 rows of cleaned data:")
print(df_cleaned.head())

# Optionally save the cleaned data
# df_cleaned.to_csv("cleaned_data.csv", index=False)

{{ macros.footer() }}