{% import "macros.j2" as macros %}

{{ macros.header(date) }}

import pandas as pd
import sys
from pathlib import Path

# Add project root to path for imports
project_root = Path(__file__).resolve().parent
while not (project_root / 'pyproject.toml').exists() and project_root != project_root.parent:
    project_root = project_root.parent

if str(project_root) not in sys.path:
    sys.path.insert(0, str(project_root))

from janitor_bot.core.janitor import Janitor

# Load your dataset using Janitor
janitor_instance = Janitor.from_csv("{{ filename or 'your_data_file.csv' }}")

# Apply cleaning operations
{{steps}}

# Get the cleaned DataFrame
df_cleaned = janitor_instance.pipeline.df

# Display results
print("Data cleaning completed!")
print(f"Final shape: {df_cleaned.shape}")
print("\nFirst 5 rows of cleaned data:")
print(df_cleaned.head())

# Optionally save the cleaned data
# df_cleaned.to_csv("cleaned_data.csv", index=False)

{{ macros.footer() }}